#summary How to set up the Classilla build environment.

===Read these directions thoroughly before you even download the source archive! Otherwise you will waste a lot of time and sweat!===

This is mostly based on http://www-archive.mozilla.org/build/mac_cfm.html with my own notes.

==Prerequisites==

===Hardware/OS===
The build environment is currently only supported on OS 9.0.4 and higher (9.1 or 9.2 recommended). It will probably build on OS 8.6 but this is considered serendipitous.

You should have ample RAM and CPU: a G4 and at least 256MB is recommended. Currently the binary builds are made on a dual 1.25GHz G4, the most powerful Power Mac that can boot OS 9 directly, with 2GB of RAM (1.5GB available to OS 9). A simple relinking takes about 15 minutes; a complete build from utter scratch needs around 90 minutes. Do the math for your own box.

===Software===

Classilla is built with Metrowerks !CodeWarrior 7.1, with a portion using the Macintosh Programmer's Workshop (MPW). It will probably build with later versions of CW, but almost certainly not with earlier ones without converting the MCPs (and possibly not even then). The reason CW 7.1 was chosen is it is fairly easy to find/purchase used.

You should not have multiple copies of MPW on your build system; only use the one that comes with !CodeWarrior. If you install multiple MPWs, you will have multiple !ToolServers which can cause your build to fail inexplicably.

To properly install the !CodeWarrior environment,
  * Run the installer(s) and select a stock full Mac C/C++ installation (Mach-O is not required; you can install that and/or Win32 if you want). Make sure that !PowerPlant, the !CodeWarrior Plugin SDK and !CodeWarrior MPW are installed.
  * Unpack the Classilla source. *This is over 30,000 files. It is strongly recommended you do this on a separate, HFS+-formatted partition or disk other than your boot volume.* In `mozilla:build:mac`, grab RunTSScript and make sure it is a !CodeWarrior plugin with Get Info (if not, drop it on !StuffIt Expander and rename the resulting !AppleDouble file back to RunTSScript). Put it in `CodeWarrior Plugins:Compilers`.
  * Enable the !ToolServer menu in the !CodeWarrior IDE. Make sure it can start !ToolServer. Make sure all the !ToolServer tools show up (in particular !MakeStubs and DumpPEF). If not, chase down all the Tools folders, remove extraneous ones, and alias them to point to a central folder. This is critical for stubs.
  * The following libraries are needed if you don't already have them:
    * Menu Sharing Toolkit. This is a part of [http://macbird.userland.com/download MacBird]. Unpack MacBird, then copy the MST portion into `MacOS Support:Menu Sharing Toolkit:`
    * ICProgKit. Unpack into `MacOS Support:ICProgKit1.4:` Later versions may work. If you can't find one, the 1.4 I use is on the Google Code site.
    * AEGizmos 1.4.2. Unpack into `MacOS Support:AEGizmos 1.4.2:` If you can't find this, the 1.4.2 I use is on the Google Code site. This used to be required, and may still be required for building direct from Mozilla code, so you may still want to install it.
    * Universal Interfaces. 3.4.1 should already be under `MacOS Support:Universal:` but if not, ftp://ftp.apple.com/developer/Development_Kits/
    * WASTE should already be under `MacOS Support:(Third Party Support):WASTE 2.0 Distribution:`

Build automation is operated with a complex !MacPerl script which functions essentially as the _make_ system. This requires some setup:

  * !MacPerl 5.2.0r4; get it from http://www.cpan.org/ports/index.html#macosclassic . I haven't tried 5.6.1 but I don't see any reason why it wouldn't work. There is no 5.8 or 5.10 for classic MacOS.
  * If you use 5.2.0r4 you will also need cpan-mac 0.50 or higher from http://sourceforge.net/projects/cpan-mac/ . This is allegedly not required for !MacPerl 5.6.1, but YMMV.
  * Next, install the following modules from http://backpan.perl.org/authors/id/C/CN/CNANDOR/ and http://www.cpan.org/modules/by-module/Archive/ . *Do not attempt to unpack them.* Drop them onto the CPAN installer applet instead (see the documentation) and they will be properly CRLF-ed and installed into the library directory. The parenthesized version is the one in use on the build system; otherwise use the latest available.
    * Compress::Zlib built for !MacPerl (1.04)
    * Archive::Zip built for !MacPerl (0.11)
    * Mac::!AppleEvents::Simple
    * Mac::Apps::Launch
  * Find your `site_perl` folder. From the Classilla source, look in `mozilla:build:mac:build_scripts`. 

(more coming)

==How to compile==

(more coming)